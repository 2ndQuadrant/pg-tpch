#echo Creating database tpch...
#createdb tpch
echo Creating table space for with fast random access
psql tpch -c "create tablespace fast_random_access LOCATION '/home/david/fast_random_access' WITH (random_page_cost = 1);"
echo Creating fixeddecimal extension...
psql tpch -c "create extension fixeddecimal;"
echo Building TPC-H schema...
psql tpch -f create_fixeddecimal.sql 
echo Loading TPC-H data...
time python loaddata.py
echo Performing Vacuum freeze...
time vacuumdb --freeze --verbose --jobs=8 --table=lineitem --table=orders --table=customer --table=nation --table=part --table=partsupp --table=region --table=supplier --dbname=tpch
echo Creating indexes...
time python index_david_v11.py
echo Creating primary keys...
time psql tpch -f primary_keys.sql
echo Building foreign key constraints...
time python foreign_keys.py
echo Applying NDISTINCT fix...
psql tpch -f ndistinct-fix-100gb.sql
echo Performing ANALYZE of tpch database...
time python analyze.py
#echo Setting column store tuples and pages...
#psql tpch -c "update pg_class set reltuples = relc.reltuples from pg_class relc join pg_cstore on (relc.oid = pg_cstore.cstrelid) where pg_cstore.cststoreid = pg_class.oid;
#update pg_class set relpages = pg_relation_size(oid) / current_setting('block_size')::int where relkind = 'C';"
echo Done.

